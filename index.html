<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Base-32 (A=10..V=31) Converter — เฟรมเวอร์</title>
  <style>
    body{font-family:system-ui,Segoe UI,Roboto,'Noto Sans',sans-serif;background:#0f1720;color:#e6eef8;padding:24px}
    .card{background:#0b1220;padding:18px;border-radius:10px;max-width:820px;margin:0 auto;box-shadow:0 6px 20px rgba(2,6,23,.6)}
    h1{font-size:20px;margin:0 0 10px}
    p.small{color:#93a4bf;margin:6px 0 16px}
    label{display:block;margin-top:10px;color:#cfe0ff}
    input[type=text], textarea, select{width:100%;padding:10px;border-radius:8px;border:1px solid #213248;background:#071826;color:#e6eef8;box-sizing:border-box}
    .row{display:flex;gap:10px;margin-top:10px}
    button{padding:10px 12px;border-radius:8px;border:0;background:#2dd4bf;color:#032024;cursor:pointer}
    button.ghost{background:#1f2937;color:#cbd5e1}
    pre{background:#071827;padding:12px;border-radius:8px;overflow:auto;color:#bfe7d4}
    .flex{display:flex;gap:8px;align-items:center}
    .outputs{margin-top:12px}
    .note{color:#93a4bf;font-size:13px;margin-top:6px}
    footer{margin-top:16px;color:#7f93b0;font-size:13px}
  </style>
</head>
<body>
  <div class="card">
    <h1>Base-32 Converter (A=10 .. V=31)</h1>
    <p class="small">พิมพ์คำ (A–V) หรือเลขฐาน 10 แล้วกด Convert — จะแสดงวิธีคิดทีละตำแหน่งและผลลัพธ์</p>

    <label>โหมด</label>
    <select id="mode">
      <option value="text2dec">Text (A–V) → Decimal</option>
      <option value="dec2base32">Decimal → Base-32 (A=10..V=31)</option>
    </select>

    <label id="inputLabel">Input (ตัวอย่าง: JURASSIC)</label>
    <input id="input" type="text" placeholder="JURASSIC หรือ 2357223036105" />

    <div class="row">
      <button id="convert">Convert</button>
      <button class="ghost" id="clear">Clear</button>
      <button class="ghost" id="copy">Copy Result</button>
    </div>

    <div class="outputs">
      <label>Result</label>
      <textarea id="result" rows="2" readonly></textarea>

      <div id="steps" style="margin-top:10px"></div>
    </div>

    <p class="note">หมายเหตุ: Alphabet ที่ใช้คือ 0–9 แล้วตามด้วย A..V (A=10, V=31)</p>
    <footer>ถ้าต้องการให้แสดงช่องขั้นตอนละเอียดกว่านี้ แค่บอกมา เดี๋ยวเพิ่มให้</footer>
  </div>

<script>
(function(){
  const alphabet = '0123456789ABCDEFGHIJKLMNOPQRSTUV'; // A..V รวม
  const charToVal = {};
  for(let i=0;i<alphabet.length;i++) charToVal[alphabet[i]] = i;

  const modeEl = document.getElementById('mode');
  const inputEl = document.getElementById('input');
  const inputLabel = document.getElementById('inputLabel');
  const convertBtn = document.getElementById('convert');
  const clearBtn = document.getElementById('clear');
  const resultEl = document.getElementById('result');
  const stepsEl = document.getElementById('steps');
  const copyBtn = document.getElementById('copy');

  modeEl.addEventListener('change', ()=>{
    const m = modeEl.value;
    if(m === 'text2dec'){
      inputLabel.textContent = 'Input (ตัวอย่าง: JURASSIC)';
      inputEl.placeholder = 'JURASSIC หรือ DINOSAURS';
    } else {
      inputLabel.textContent = 'Input Decimal (ตัวอย่าง: 2357223036105)';
      inputEl.placeholder = '2357223036105';
    }
    resultEl.value = '';
    stepsEl.innerHTML = '';
  });

  clearBtn.addEventListener('click', ()=>{ inputEl.value=''; resultEl.value=''; stepsEl.innerHTML=''; });

  copyBtn.addEventListener('click', ()=>{
    if(resultEl.value) navigator.clipboard?.writeText(resultEl.value).then(()=> alert('คัดลอกแล้ว'));
  });

  convertBtn.addEventListener('click', ()=>{
    stepsEl.innerHTML = '';
    const mode = modeEl.value;
    const raw = inputEl.value.trim();
    if(!raw){ alert('ใส่ค่าในช่องก่อน'); return; }

    if(mode === 'text2dec'){
      const s = raw.toUpperCase().replace(/\s+/g,'');
      // validate
      for(const ch of s){
        if(!(ch in charToVal)) { alert('พบตัวอักษรไม่รองรับ: ' + ch + '\nใช้เฉพาะ 0-9, A-V'); return; }
        if(charToVal[ch] >= 32) { alert('ตัวอักษรนอกช่วง base-32: '+ch); return; }
      }

      // compute per-position: left to right
      let acc = BigInt(0);
      const base = BigInt(32);
      const n = s.length;
      const lines = [];
      for(let i=0;i<n;i++){
        const ch = s[i];
        const val = BigInt(charToVal[ch]);
        const exp = BigInt(n - 1 - i);
        const pow = base ** exp; // BigInt pow
        const contrib = val * pow;
        lines.push({pos: i, ch, val: Number(val), exp: Number(exp), pow: pow.toString(), contrib: contrib.toString()});
        acc = acc + contrib;
      }

      resultEl.value = acc.toString();

      // show steps
      let html = '<pre>';
      html += 'การแปลง: "' + s + '" (base-32) → decimal\n\n';
      lines.forEach(it=>{
        html += `${it.ch} (=${it.val}) × 32^${it.exp} (= ${it.pow})  →  contribution = ${it.contrib}\n`;
      });
      html += '\nผลรวม = ' + acc.toString() + '\n';
      html += '</pre>';
      stepsEl.innerHTML = html;

    } else {
      // decimal to base32
      // validate decimal as integer
      let decStr = raw.replace(/,/g,'');
      if(!/^[-+]?\d+$/.test(decStr)) { alert('ใส่เฉพาะเลขฐาน 10 เต็มๆ ได้ เช่น 2357223036105'); return; }
      let negative = false;
      if(decStr.startsWith('-')){ negative = true; decStr = decStr.slice(1); }

      let x = BigInt(decStr);
      const base = BigInt(32);
      if(x === BigInt(0)){
        resultEl.value = '0';
        stepsEl.innerHTML = '<pre>0 (decimal) → 0 (base-32)</pre>';
        return;
      }

      const digs = [];
      const steps = [];
      while(x > 0){
        const q = x / base;
        const r = x % base;
        steps.push({x: x.toString(), q: q.toString(), r: Number(r)});
        digs.push(Number(r));
        x = q;
      }
      const mapped = digs.reverse().map(d => alphabet[d]).join('');
      resultEl.value = (negative?'-':'') + mapped;

      // show steps
      let html = '<pre>';
      html += `การแปลง decimal → base-32 (A=10..V=31)\n\n`;
      steps.forEach(it=>{
        html += `${it.x} ÷ 32 = ${it.q}  เหลือเศษ ${it.r} (${alphabet[it.r]})\n`;
      });
      html += `\nคำตอบ (base-32) = ${mapped}`;
      html += '</pre>';
      stepsEl.innerHTML = html;
    }
  });

})();
</script>
</body>
</html>
